# Full Architecture: Triple-Hybrid + ETD + LaDiR + Block Diffusion + MTP

**ì°¨ì„¸ëŒ€ LLMì„ ìœ„í•œ í†µí•© ì•„í‚¤í…ì²˜**

---

## 1. ì „ì²´ ì•„í‚¤í…ì²˜ ê°œìš”

### í•µì‹¬ ê°œë…: ìˆ˜í‰ ë°ì´í„° íë¦„ + ìˆ˜ì§ ë ˆì´ì–´ ìŠ¤íƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FULL ARCHITECTURE (ë°ì´í„° íë¦„)                          â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                        INPUT SEQUENCE                                 â”‚  â”‚
â”‚  â”‚  [Question Tokens] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  BACKBONE + ETD (Triple-Hybrid layers organized by ETD)              â”‚  â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚   ENCODER (8)        THINK (24, NíšŒ ë°˜ë³µ)        DECODER (8)         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚
â”‚  â”‚  â”‚ M3â”‚GDâ”‚GD â”‚  â†’   â”‚ M3â”‚M3â”‚GDâ”‚GDâ”‚GAâ”‚GDâ”‚  â†’   â”‚ GAâ”‚GAâ”‚GD â”‚           â”‚  â”‚
â”‚  â”‚  â”‚ GDâ”‚GAâ”‚GD â”‚      â”‚    ... x24       â”‚      â”‚ GAâ”‚M3â”‚GA â”‚           â”‚  â”‚
â”‚  â”‚  â”‚ M3â”‚GAâ”‚   â”‚      â”‚ +Router +Expert  â”‚      â”‚ GDâ”‚M3â”‚   â”‚           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚
â”‚  â”‚  DeltaNet ìœ„ì£¼       ê· í˜• (4:4:2)            Attention ìœ„ì£¼          â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  LaDiR: LATENT REASONING (ì‹œí€€ìŠ¤ ëì— Memory Slots ì¶”ê°€)              â”‚  â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚   [Hidden States] + [MEMâ‚] [MEMâ‚‚] [MEMâ‚ƒ]  â† 3ê°œ Memory Slots         â”‚  â”‚
â”‚  â”‚                          â”‚                                           â”‚  â”‚
â”‚  â”‚                          â–¼                                           â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚   â”‚  VAE Encoder: Memory Slots â†’ Latent z (ì••ì¶•)               â”‚    â”‚  â”‚
â”‚  â”‚   â”‚  Flow Matching: Noise â†’ Latent z (ìƒì„±)                    â”‚    â”‚  â”‚
â”‚  â”‚   â”‚  Prophet: Confidence gap ê¸°ë°˜ ì¡°ê¸° ì¢…ë£Œ                    â”‚    â”‚  â”‚
â”‚  â”‚   â”‚  VAE Decoder: Latent z â†’ Memory Slots (ë³µì›)               â”‚    â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â”‚                          â”‚                                           â”‚  â”‚
â”‚  â”‚   [Hidden States with Reasoning] â† Memory Slotsê°€ ì¶”ë¡  ì •ë³´ ë‹´ìŒ     â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  OUTPUT: Block Diffusion (AR + Diffusion í•˜ì´ë¸Œë¦¬ë“œ)                 â”‚  â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚   Block 1: [MASK] â†’ Diffusion â†’ [Tokens]   â† ë¸”ë¡ ë‚´ ë³‘ë ¬ ìƒì„±      â”‚  â”‚
â”‚  â”‚   Block 2: [MASK] â†’ Diffusion â†’ [Tokens]   â† ARë¡œ ë‹¤ìŒ ë¸”ë¡         â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â”‚   âœ… LaDiRê³¼ ë™ì¼í•œ Diffusion íŒ¨ëŸ¬ë‹¤ì„ìœ¼ë¡œ í†µì¼                      â”‚  â”‚
â”‚  â”‚                                                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                        OUTPUT TOKENS                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

M3 = Mamba-3, GD = Gated DeltaNet, GA = Gated Attention
```

### CoCoNut vs LaDiR: ìœ„ì¹˜ëŠ” ê°™ê³ , ë°©ì‹ë§Œ ë‹¤ë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CoCoNut vs LaDiR ë¹„êµ                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  CoCoNut (Original)                                                 â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  [Question] + [<BOT> Tâ‚ Tâ‚‚ Tâ‚ƒ ... Tâ‚™ <EOT>]                        â”‚   â”‚
â”‚  â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚   â”‚
â”‚  â”‚                       Nê°œ Thought Tokens                            â”‚   â”‚
â”‚  â”‚                       (ì‹œí€€ìŠ¤ ENDì— ìœ„ì¹˜)                           â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  ìƒì„±: Autoregressive (í•œ í† í°ì”© ìˆœì°¨ ìƒì„±)                         â”‚   â”‚
â”‚  â”‚  í•™ìŠµ: Curriculum Learning í•„ìš”                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  LaDiR (Latent Diffusion Reasoning)                                 â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                 â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  [Question] + [MEMâ‚] [MEMâ‚‚] [MEMâ‚ƒ]                                 â”‚   â”‚
â”‚  â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚   â”‚
â”‚  â”‚                3ê°œ Memory Slots                                     â”‚   â”‚
â”‚  â”‚                (ì‹œí€€ìŠ¤ ENDì— ìœ„ì¹˜) â† ìœ„ì¹˜ëŠ” CoCoNutê³¼ ë™ì¼!         â”‚   â”‚
â”‚  â”‚                                                                     â”‚   â”‚
â”‚  â”‚  ìƒì„±: Diffusion (ë³‘ë ¬ ìƒì„±, Prophet ì¡°ê¸° ì¢…ë£Œ)                     â”‚   â”‚
â”‚  â”‚  í•™ìŠµ: VAE â†’ Diffusion 2ë‹¨ê³„ í•™ìŠµ                                   â”‚   â”‚
â”‚  â”‚  ì••ì¶•ë¥ : ~512x (ê¸´ CoTë¥¼ 3ê°œ í† í°ìœ¼ë¡œ ì••ì¶•)                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  âš ï¸ í•µì‹¬ ì°¨ì´:                                                              â”‚
â”‚  â€¢ ìœ„ì¹˜: ë‘˜ ë‹¤ ì‹œí€€ìŠ¤ END (ë™ì¼)                                           â”‚
â”‚  â€¢ í† í° ìˆ˜: CoCoNut Nê°œ vs LaDiR 3ê°œ (ì••ì¶•)                                â”‚
â”‚  â€¢ ìƒì„± ë°©ì‹: AR vs Diffusion                                              â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ETDì™€ LaDiRì˜ ê´€ê³„ (ìˆ˜ì •ë¨)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ê´€ê³„ ë‹¤ì´ì–´ê·¸ë¨ (ìˆ˜ì •)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Triple-Hybrid: "ë ˆì´ì–´ íƒ€ì…" ì œê³µ (Mamba-3 / DeltaNet / Attention)         â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚  ETD: "ë ˆì´ì–´ ì¡°ì§í™”" (Encoder / Think / Decoder)                           â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â”‚   â† ETD ë‚´ë¶€ì—ì„œëŠ” ë ˆì´ì–´ë§Œ ë°˜ë³µ, LaDiRì€ ì—¬ê¸° ì—†ìŒ                  â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚  LaDiR: "ì‹œí€€ìŠ¤ ëì—ì„œ" Latent Reasoning ìˆ˜í–‰                               â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â”‚   â† ETD ì²˜ë¦¬ í›„, ì‹œí€€ìŠ¤ ëì— Memory Slots ì¶”ê°€                      â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚  Output: MTP ë˜ëŠ” Block Diffusionìœ¼ë¡œ ì¶œë ¥ ê°€ì†                             â”‚
â”‚                                                                             â”‚
â”‚  âš ï¸ ìˆ˜ì •ëœ í•µì‹¬ í¬ì¸íŠ¸:                                                      â”‚
â”‚  â€¢ ETD: ë ˆì´ì–´ ë°˜ë³µ (Think ë¸”ë¡ NíšŒ ì‹¤í–‰)                                   â”‚
â”‚  â€¢ LaDiR: ì‹œí€€ìŠ¤ ëì—ì„œ ì‘ë™ (ETD ë‚´ë¶€ ì•„ë‹˜!)                               â”‚
â”‚  â€¢ ë‘˜ì€ ìˆœì°¨ì  ê´€ê³„ (ETD â†’ LaDiR â†’ Output)                                  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ê° ë ˆì´ì–´ ìƒì„¸

### Layer 1: Backbone (Triple-Hybrid) - "ì–´ë–¤ ë ˆì´ì–´?"

| ì»´í¬ë„ŒíŠ¸ | íŒŒì¼ | ì—­í•  | ë©”ëª¨ë¦¬ íƒ€ì… | ë¹„ìœ¨ |
|---------|------|------|------------|------|
| **Mamba-3** | `mamba_memory.py` | ì‹¬ì¸µ ì¥ê¸° ê¸°ì–µ | ë³µì†Œìˆ˜ ìƒíƒœ ê³µê°„ | 40% |
| **Gated DeltaNet** | `gated_deltanet.py` | ê³ ì† ì‘ì—… ê¸°ì–µ | ì—°ê´€ í–‰ë ¬ (dÃ—d) | 40% |
| **Gated Attention** | `attention/` | ì§‘ì¤‘ ì£¼ì˜ | KV Cache | 20% |

### Layer 2: ETD Structure - "ì–´ë–»ê²Œ êµ¬ì¡°í™”?"

| ì»´í¬ë„ŒíŠ¸ | ì—­í•  | íŠ¹ì§• |
|---------|------|------|
| **Encoder** | ì…ë ¥ ì²˜ë¦¬ | 1íšŒ ì‹¤í–‰ |
| **Think** | ì‚¬ê³ /ì¶”ë¡  | NíšŒ ë°˜ë³µ (í•µì‹¬) |
| **Decoder** | ì¶œë ¥ ìƒì„± | 1íšŒ ì‹¤í–‰ |
| **Router** | ë™ì  ê¹Šì´ | Skip/Execute/Repeat |
| **MoDr** | ì „ë¬¸ê°€ ë¶„ê¸° | LoRA ê¸°ë°˜ |

### Layer 3: LaDiR Reasoning - "ì–´ë–»ê²Œ ì¶”ë¡ ?"

| ì»´í¬ë„ŒíŠ¸ | ì—­í•  | íŠ¹ì§• |
|---------|------|------|
| **LaDiRVAE** | ì••ì¶• | Reasoning â†’ Latent |
| **LaDiRDiffusion** | ìƒì„± | Flow Matching |
| **ProphetEarlyExit** | ê°€ì† | Confidence gap ê¸°ë°˜ ì¡°ê¸° ì¢…ë£Œ |

### Output Generation - "ì–´ë–»ê²Œ ì¶œë ¥?"

| ì»´í¬ë„ŒíŠ¸ | íŒŒì¼ | ì—­í•  | íŠ¹ì§• |
|---------|------|------|------|
| **Block Diffusion** | `block_diffusion.py` | AR+Diffusion í•˜ì´ë¸Œë¦¬ë“œ | âœ… ë©”ì¸ (LaDiRê³¼ í†µì¼) |

> **ì„ íƒ ì´ìœ **: LaDiRê³¼ ë™ì¼í•œ Diffusion íŒ¨ëŸ¬ë‹¤ì„ ì‚¬ìš© â†’ ì•„í‚¤í…ì²˜ ì¼ê´€ì„±

---

## 3. ë°ì´í„° íë¦„

```
Input Tokens
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ENCODER (ETD)                              â”‚
â”‚  Triple-Hybrid layers: mostly DeltaNet for local patterns       â”‚
â”‚  [DeltaNet] â†’ [DeltaNet] â†’ [Mamba] â†’ [DeltaNet] â†’ ...          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       THINK (ETD)                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  Iteration 1-N (NíšŒ ë°˜ë³µ)                                  â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚
â”‚  â”‚  â”‚ Triple-Hybrid Block                                â”‚   â”‚â”‚
â”‚  â”‚  â”‚ [Mamba-3] â†’ [DeltaNet] â†’ [Attention] â†’ ...         â”‚   â”‚â”‚
â”‚  â”‚  â”‚     +Router (Skip/Execute/Repeat)                  â”‚   â”‚â”‚
â”‚  â”‚  â”‚     +LoRA Experts (MoDr)                           â”‚   â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚
â”‚  â”‚                                                            â”‚â”‚
â”‚  â”‚  âš ï¸ LaDiRì€ ì—¬ê¸° ì—†ìŒ! (ETD ë‚´ë¶€ ì•„ë‹˜)                      â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DECODER (ETD)                              â”‚
â”‚  Triple-Hybrid layers: Attention + DeltaNet for output          â”‚
â”‚  [Attention] â†’ [DeltaNet] â†’ [Attention] â†’ ...                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   LaDiR (ì‹œí€€ìŠ¤ ENDì— ìœ„ì¹˜)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  [Hidden States] + [MEMâ‚] [MEMâ‚‚] [MEMâ‚ƒ]  â† Memory Slots    â”‚â”‚
â”‚  â”‚                                                            â”‚â”‚
â”‚  â”‚  Training: VAEë¡œ CoT ì••ì¶• í•™ìŠµ                              â”‚â”‚
â”‚  â”‚  Inference: Diffusion + Prophetìœ¼ë¡œ Memory ìƒì„±             â”‚â”‚
â”‚  â”‚                                                            â”‚â”‚
â”‚  â”‚  âš ï¸ ETD ì´í›„ì— ì ìš©! (ETD ë‚´ë¶€ ì•„ë‹˜)                         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   OUTPUT: Block Diffusion                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  AR between blocks + Diffusion within blocks               â”‚â”‚
â”‚  â”‚                                                            â”‚â”‚
â”‚  â”‚  Block 1: [MASKÃ—4] â†’ Denoise â†’ [Tâ‚ Tâ‚‚ Tâ‚ƒ Tâ‚„]              â”‚â”‚
â”‚  â”‚  Block 2: [MASKÃ—4] â†’ Denoise â†’ [Tâ‚… Tâ‚† Tâ‚‡ Tâ‚ˆ]              â”‚â”‚
â”‚  â”‚  ...                                                       â”‚â”‚
â”‚  â”‚                                                            â”‚â”‚
â”‚  â”‚  âœ… LaDiRê³¼ ë™ì¼í•œ Diffusion íŒ¨ëŸ¬ë‹¤ì„                       â”‚â”‚
â”‚  â”‚  âœ… ì–‘ë°©í–¥ Attentionìœ¼ë¡œ ì¼ê´€ì„± ìœ ì§€                        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
Output Tokens
```

---

## 4. íŒŒì¼ êµ¬ì¡°

```
OLMo-core/src/olmo_core/nn/transformer/
â”‚
â”œâ”€â”€ [BACKBONE - Layer 1: Triple-Hybrid]
â”‚   â”‚
â”‚   â”œâ”€â”€ mamba_memory.py          # ğŸ†• Mamba-3 (Deep Long-term Memory)
â”‚   â”‚   â”œâ”€â”€ MambaMemoryConfig
â”‚   â”‚   â”œâ”€â”€ MambaMemory
â”‚   â”‚   â””â”€â”€ MambaMemoryBlock
â”‚   â”‚
â”‚   â”œâ”€â”€ gated_deltanet.py        # âœ… ê¸°ì¡´ (Working Memory)
â”‚   â”‚   â”œâ”€â”€ GatedDeltaNetConfig
â”‚   â”‚   â”œâ”€â”€ GatedDeltaNet
â”‚   â”‚   â””â”€â”€ GatedDeltaNetBlock
â”‚   â”‚
â”‚   â”œâ”€â”€ attention/               # âœ… ê¸°ì¡´ (Focused Attention)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ flash_attn_api.py
â”‚   â”‚   â”œâ”€â”€ kv_cache.py
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ triple_hybrid.py         # ğŸ†• í†µí•© (Layer ì¡°í•©)
â”‚       â”œâ”€â”€ TripleHybridConfig
â”‚       â”œâ”€â”€ TripleHybridBlock
â”‚       â””â”€â”€ LayerScheduler
â”‚
â”œâ”€â”€ [ETD STRUCTURE - Layer Organization]
â”‚   â”‚
â”‚   â””â”€â”€ etd.py                   # âœ… ì—…ë°ì´íŠ¸ (ETD + Triple-Hybrid í†µí•©)
â”‚       â”œâ”€â”€ ETDConfig            (ê¸°ì¡´ ETD ì„¤ì •)
â”‚       â”œâ”€â”€ ETDTransformer       (ê¸°ì¡´ ë¸”ë¡ ë˜í•‘)
â”‚       â”œâ”€â”€ ThinkBlockController (ì ì‘í˜• ê¹Šì´)
â”‚       â”œâ”€â”€ LayerRouter          (Skip/Execute/Repeat)
â”‚       â”œâ”€â”€ MoDrExpertRouter     (LoRA experts)
â”‚       â”‚
â”‚       â”œâ”€â”€ [ETD + Triple-Hybrid í†µí•©] ğŸ†•
â”‚       â”œâ”€â”€ BackboneType         (STANDARD / TRIPLE_HYBRID)
â”‚       â”œâ”€â”€ ETDTripleHybridConfig (í†µí•© ì„¤ì •)
â”‚       â”œâ”€â”€ ETDTripleHybridTransformer (E-T-D + Triple-Hybrid)
â”‚       â””â”€â”€ create_etd_triple_hybrid_model() (í—¬í¼ í•¨ìˆ˜)
â”‚
â”œâ”€â”€ [REASONING - Layer 3: LaDiR] (ì‹œí€€ìŠ¤ ENDì—ì„œ ì‘ë™!)
â”‚   â”‚
â”‚   â””â”€â”€ latent_reasoning.py      # âœ… ìˆ˜ì • (LaDiRë§Œ ìœ ì§€)
â”‚       â”œâ”€â”€ LaDiRConfig          (VAE + Diffusion ì„¤ì •)
â”‚       â”œâ”€â”€ ProphetConfig        (ì¡°ê¸° ì¢…ë£Œ ì„¤ì •)
â”‚       â”œâ”€â”€ LaDiRVAE             (Text â†’ Latent ì••ì¶•)
â”‚       â”œâ”€â”€ LaDiRDiffusion       (Flow Matching ìƒì„±)
â”‚       â”œâ”€â”€ FlowMatchingScheduler (Noise scheduler)
â”‚       â”œâ”€â”€ ProphetEarlyExit     (Confidence gap ì¡°ê¸° ì¢…ë£Œ)
â”‚       â”œâ”€â”€ LaDiRModule          (ğŸ†• ì‹œí€€ìŠ¤ ENDì—ì„œ ì‘ë™)
â”‚       â””â”€â”€ LatentReasoningWrapper (ğŸ†• ETD ì¶œë ¥ í›„ LaDiR ì ìš©)
â”‚
â”œâ”€â”€ [OUTPUT GENERATION]
â”‚   â”‚
â”‚   â””â”€â”€ block_diffusion.py       # âœ… ë©”ì¸ (Block Discrete Diffusion)
â”‚       â”œâ”€â”€ BlockDiffusionConfig
â”‚       â”œâ”€â”€ NoiseSchedule (LogLinear, Cosine, Exp)
â”‚       â”œâ”€â”€ MaskDiffusion
â”‚       â”œâ”€â”€ BlockDiffusionDecoder
â”‚       â””â”€â”€ BlockDiffusionWrapper
â”‚
â”œâ”€â”€ [OPTIONAL - ëŒ€ì•ˆì  ì¶œë ¥]
â”‚   â”‚
â”‚   â””â”€â”€ mtp.py                   # ëŒ€ì•ˆ (ì†ë„ ìš°ì„ ì‹œ)
â”‚       â”œâ”€â”€ MTPConfig
â”‚       â”œâ”€â”€ MTPHead
â”‚       â””â”€â”€ MTPSpeculativeDecoder
â”‚
â”œâ”€â”€ [CORE]
â”‚   â”œâ”€â”€ block.py                 # ê¸°ë³¸ Transformer block
â”‚   â”œâ”€â”€ model.py                 # Transformer ëª¨ë¸
â”‚   â””â”€â”€ config.py                # ì„¤ì •
â”‚
â”œâ”€â”€ [DEPRECATED - ì œê±° ì˜ˆì •]
â”‚   â”‚
â”‚   â””â”€â”€ latent_reasoning.py ì—ì„œ ì œê±°:
â”‚       â”œâ”€â”€ ContinuousThought
â”‚       â”œâ”€â”€ CODIDistillation
â”‚       â”œâ”€â”€ PCCoTJacobiSolver
â”‚       â”œâ”€â”€ KaVaDistillation
â”‚       â”œâ”€â”€ SoftCoTProjection
â”‚       â””â”€â”€ LatentReasoningMode (COCONUT, CODI, PCCOT, KAVA, SOFTCOT)
â”‚
â””â”€â”€ [DOCS]
    â””â”€â”€ TRIPLE_HYBRID_ARCHITECTURE.md  # ì´ ë¬¸ì„œ
```

---

## 5. í†µí•© Configuration

```python
from dataclasses import dataclass, field
from olmo_core.config import Config

@dataclass
class FullArchitectureConfig(Config):
    """ì „ì²´ ì•„í‚¤í…ì²˜ í†µí•© ì„¤ì •"""

    # === Layer 1: Triple-Hybrid Backbone ===
    backbone: TripleHybridConfig = field(default_factory=lambda: TripleHybridConfig(
        d_model=2048,
        n_layers=40,
        mamba_ratio=0.4,      # 40% Mamba-3 (ì¥ê¸° ê¸°ì–µ)
        deltanet_ratio=0.4,   # 40% DeltaNet (ì‘ì—… ê¸°ì–µ)
        attention_ratio=0.2,  # 20% Attention (ì •ë°€ ê²€ìƒ‰)
    ))

    # === Layer 2: ETD Structure ===
    etd: ETDConfig = field(default_factory=lambda: ETDConfig(
        num_encoder_layers=8,
        num_think_layers=24,   # Think ë¸”ë¡ì´ ëŒ€ë¶€ë¶„
        num_decoder_layers=8,
        think_iterations=4,    # Think ë°˜ë³µ íšŸìˆ˜
        use_router=True,       # ë™ì  ë¼ìš°íŒ…
    ))

    # === Layer 3: LaDiR Reasoning ===
    ladir: LaDiRConfig = field(default_factory=lambda: LaDiRConfig(
        latent_dim=128,
        num_memory_slots=3,
        num_inference_steps=50,
        prophet=ProphetConfig(
            enabled=True,
            threshold_early=7.5,
            threshold_mid=5.0,
            threshold_late=2.5,
        ),
    ))

    # === Output Acceleration ===
    mtp: MTPConfig = field(default_factory=lambda: MTPConfig(
        num_predict_tokens=4,  # 4 í† í° ë™ì‹œ ì˜ˆì¸¡
        use_speculative=True,
    ))

    block_diffusion: BlockDiffusionConfig = field(default_factory=lambda: BlockDiffusionConfig(
        block_size=16,
        noise_schedule="log_linear",
    ))
```

---

## 6. Implementation Roadmap

### Phase 1: Backbone (Triple-Hybrid) âœ… COMPLETED
- [x] `mamba_memory.py` ìƒì„± - Mamba-3 (Complex SSM) êµ¬í˜„
- [x] `triple_hybrid.py` ìƒì„± - 4:4:2 ë¹„ìœ¨ ë ˆì´ì–´ ì¡°í•©
- [x] ê¸°ì¡´ `gated_deltanet.py` ì—°ë™ í™•ì¸

### Phase 2: ETD Integration âœ… COMPLETED
- [x] `etd.py`ì™€ Triple-Hybrid í†µí•©
  - [x] `BackboneType` enum ì¶”ê°€
  - [x] `ETDTripleHybridConfig` ìƒì„±
  - [x] `ETDTripleHybridTransformer` êµ¬í˜„
  - [x] `create_etd_triple_hybrid_model()` í—¬í¼ í•¨ìˆ˜
- [x] Think Blockì—ì„œ Triple-Hybrid ë ˆì´ì–´ ì‚¬ìš©í•˜ë„ë¡ ìˆ˜ì •
  - [x] ì„¹ì…˜ë³„ ë‹¤ë¥¸ ë ˆì´ì–´ ë¹„ìœ¨ ì§€ì› (Encoder/Think/Decoder)
  - [x] LayerRouter + MoDrExpert í†µí•©

### Phase 3: LaDiR Cleanup âœ… COMPLETED
- [x] `latent_reasoning.py` deprecated ì½”ë“œ ì œê±°
  - [x] `ContinuousThought` ì œê±°
  - [x] `CODIDistillation` ì œê±°
  - [x] `PCCoTJacobiSolver` ì œê±°
  - [x] `KaVaDistillation` ì œê±°
  - [x] `SoftCoTProjection` ì œê±°
  - [x] ê´€ë ¨ Mode enum ì •ë¦¬ (LADIRë§Œ ìœ ì§€)
- [x] LaDiR ì „ìš©ìœ¼ë¡œ ì •ë¦¬

### Phase 4: Output Layer Integration
- [ ] `mtp.py` ì—°ë™ í™•ì¸
- [ ] `block_diffusion.py` ì—°ë™ í™•ì¸

### Phase 5: Full Integration & Testing
- [ ] ì „ì²´ íŒŒì´í”„ë¼ì¸ í†µí•©
- [ ] Configuration í†µí•© í´ë˜ìŠ¤ ìƒì„±
- [ ] ë‹¨ìœ„/í†µí•© í…ŒìŠ¤íŠ¸
- [ ] ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬

---

## 7. Summary

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ARCHITECTURE SUMMARY                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  Q: ì–´ë–¤ ë ˆì´ì–´?     â†’ Triple-Hybrid (Mamba + DeltaNet + Attn) â”‚
â”‚  Q: ì–´ë–»ê²Œ êµ¬ì¡°í™”?   â†’ ETD (Encode-Think-Decode)               â”‚
â”‚  Q: ì–´ë–»ê²Œ ì¶”ë¡ ?     â†’ LaDiR (VAE + Flow + Prophet)            â”‚
â”‚  Q: ì–´ë–»ê²Œ ì¶œë ¥?     â†’ MTP + Block Diffusion                   â”‚
â”‚                                                                â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” â”‚
â”‚                                                                â”‚
â”‚  Files:                                                        â”‚
â”‚  â”œâ”€ Backbone                                                   â”‚
â”‚  â”‚  â€¢ mamba_memory.py      (âœ… ì™„ë£Œ - Mamba-3 Complex SSM)     â”‚
â”‚  â”‚  â€¢ gated_deltanet.py    (âœ… ê¸°ì¡´)                           â”‚
â”‚  â”‚  â€¢ triple_hybrid.py     (âœ… ì™„ë£Œ - 4:4:2 ì¡°í•©)              â”‚
â”‚  â”‚                                                             â”‚
â”‚  â”œâ”€ Structure                                                  â”‚
â”‚  â”‚  â€¢ etd.py               (âœ… ê¸°ì¡´)                           â”‚
â”‚  â”‚                                                             â”‚
â”‚  â”œâ”€ Reasoning                                                  â”‚
â”‚  â”‚  â€¢ latent_reasoning.py  (âœ… ì™„ë£Œ - LaDiR only)              â”‚
â”‚  â”‚                                                             â”‚
â”‚  â””â”€ Output                                                     â”‚
â”‚     â€¢ mtp.py               (âœ… ê¸°ì¡´)                           â”‚
â”‚     â€¢ block_diffusion.py   (âœ… ê¸°ì¡´)                           â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. References

1. **Mamba-3**: "Improved Sequence Modeling using State Space Principles" (2025)
2. **Gated DeltaNet**: "Improving Mamba2 with Delta Rule" (arXiv:2412.06464)
3. **ETD**: "Encode, Think, Decode" (arXiv:2510.07358)
4. **LaDiR**: "Latent Diffusion for Reasoning" (arXiv:2510.08558)
5. **Prophet**: "Early Commit Decoding" (arXiv:2508.19982)
6. **BD3-LM**: "Block Discrete Denoising Diffusion" (arXiv:2503.09573, ICLR 2025)
7. **MTP**: "Multi-token Prediction" (arXiv:2404.19737, Meta)
8. **Triple-Hybrid Report**: ë‚´ë¶€ ì•„í‚¤í…ì²˜ ë¶„ì„ ë¬¸ì„œ

---

*ë¬¸ì„œ ì‘ì„±ì¼: 2025-12-05*
*ì‘ì„±ì: AI Architect*
